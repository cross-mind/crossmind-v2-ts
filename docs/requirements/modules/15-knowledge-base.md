# 知识库 - 需求设计文档

> 📖 **相关文档**：[PRD](../../PRD.md) | [AI 能力集成](./12-ai-integration.md)

**文档版本**: 1.0
**最后更新**: 2024-12-08
**负责人**: 产品团队

---

## 1. 模块概述

### 1.1 模块定位

**核心价值**: 自动归档项目知识，支持智能检索，自动生成周报。

**使用场景**:
- 搜索历史内容
- 查看项目知识沉淀
- 自动生成周报

### 1.2 优先级

- **P1**: 自动归档、RAG 检索
- **P2**: 周报生成、导出功能

---

## 2. 核心用户场景

### 场景 2.1: 搜索历史内容

**基本流程**:
```
用户输入"市场调研"
    ↓
RAG 检索相关内容
    ↓
显示结果：
  - Canvas 节点："市场调研"
  - 任务："完成用户调研"
  - Agent 产出："Reddit 调研报告"
  - 对话记录：提到"市场调研"的对话
    ↓
用户点击结果 → 跳转到原内容
```

### 场景 2.2: 自动生成周报

**基本流程**:
```
系统每周日晚自动触发
    ↓
汇总本周数据：
  - 新增/完成的节点
  - 完成的任务
  - Agent 产出
    ↓
AI 生成周报 Markdown
    ↓
发送通知："本周周报已生成"
    ↓
用户查看和导出
```

---

## 3. 功能详细设计

### 3.1 自动归档

**归档内容**:
- Canvas 节点（完整历史）
- 任务及评论
- Agent 产出
- AI 对话记录

**归档时机**: 实时自动归档

**优先级**: P1

### 3.2 RAG 检索

#### 3.2.1 全文搜索

**支持**: 标题、内容、评论

**优先级**: P1

#### 3.2.2 语义搜索

**能力**: 理解语义，匹配相关内容

**示例**: 搜索"竞争对手"，匹配"竞品分析"

**优先级**: P1

#### 3.2.3 过滤

**维度**:
- 内容类型（节点/任务/对话）
- 时间范围
- 标签

**优先级**: P2

### 3.3 周报生成 (P2)

**生成内容**:
- 本周亮点
- Canvas 节点变化
- 任务完成情况
- Agent 产出汇总

**触发**: 自动（每周）或手动

**格式**: Markdown

**优先级**: P2

### 3.4 导出功能 (P2)

**支持格式**:
- Markdown
- PDF
- PPT（简化版）

**导出范围**:
- 单个节点/任务
- 整个项目
- 自定义选择

**优先级**: P2

---

## 4. 验收标准

- [ ] 搜索准确性 > 80%
- [ ] 搜索响应 < 1s
- [ ] 周报内容完整
- [ ] 导出格式正确

---

## 附录

### A. 术语表

| 术语 | 定义 |
|-----|-----|
| RAG | 检索增强生成 |
| 语义搜索 | 基于语义理解的搜索 |
| 周报 | 自动生成的周进度报告 |

### B. 变更历史

| 版本 | 日期 | 变更内容 | 负责人 |
|-----|------|---------|-------|
| 1.0 | 2024-12-08 | 初始版本 | 产品团队 |
